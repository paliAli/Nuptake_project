labs(x = "NDRE", y = "N uptake (g/m2)", title = "NDRE vs N uptake (exponential)") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text(margin = margin(b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_NDRE$meanNDRE) + 0.02,
y = max(Nuptake_NDRE$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)
),
hjust = 0,
vjust = 1,
color = "black",
size = 6
)+
scale_shape_manual(values = c(16, 17))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_NDRE_plot
ggsave("NDREvsNuptake_exp.png", exponential_Nuptake_NDRE_plot, width = 7, height = 10, dpi = 350)
exponential_model <- lm(log(mean_Nuptake) ~ meanNDVI, data = Nuptake_NDVI)
summary(exponential_model)
# Extract coefficients
exponential_coef <- coef(exponential_model)
intercept_exp <- exponential_coef[1]
slope_exp <- exponential_coef[2]
r_squared_exp <- 1 - sum(residuals(exponential_model)^2) / sum((log(Nuptake_NDVI$mean_Nuptake) - mean(log(Nuptake_NDVI$mean_Nuptake)))^2)
exponential_Nuptake_NDVI_plot <- Nuptake_NDVI %>%
ggplot(aes(x = meanNDVI, y = mean_Nuptake, group = 1))+
geom_point(aes(shape = factor(material)), size = 3)+
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue", aes(group = 1))+
labs(x = "NDVI", y = "N uptake (g/m2)", title = "NDVI vs N uptake (exponential)")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_NDVI$meanNDVI) + 0.02,
y = max(Nuptake_NDVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)
),
hjust = 0, vjust = 1, color = "black", size = 6
)+
scale_shape_manual(values = c(16, 17))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_NDVI_plot
ggsave("NDVIvsNuptake_exp.png", exponential_Nuptake_NDVI_plot, width = 7, height = 10, dpi = 350)
# Fit an exponential model
exponential_model <- lm(log(mean_Nuptake) ~ meanEVI, data = Nuptake_EVI)
summary(exponential_model)
# Extract coefficients
exponential_coef <- coef(exponential_model)
intercept_exp <- exponential_coef[1]
slope_exp <- exponential_coef[2]
# Calculate R-squared for the exponential model
r_squared_exp <- 1 - sum(residuals(exponential_model)^2) / sum((log(Nuptake_EVI$mean_Nuptake) - mean(log(Nuptake_EVI$mean_Nuptake)))^2)
# Plot the exponential relationship
exponential_Nuptake_EVI_plot <- Nuptake_EVI %>%
ggplot(aes(x = meanEVI, y = mean_Nuptake)) +
geom_point() +
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue") +
labs(x = "EVI", y = "", title = "EVI vs N uptake (exponential)") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text(margin = margin(b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_EVI$meanEVI) + 0.02,
y = max(Nuptake_EVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2),
"\nCorrelation:", round(cor(Nuptake_EVI$meanEVI, Nuptake_EVI$mean_Nuptake), 2)
),
hjust = 0,
vjust = 1,
color = "black",
size = 6
)
exponential_Nuptake_EVI_plot
# Fit an exponential model
exponential_model <- lm(log(mean_Nuptake) ~ meanEVI, data = Nuptake_EVI)
summary(exponential_model)
# Extract coefficients
exponential_coef <- coef(exponential_model)
intercept_exp <- exponential_coef[1]
slope_exp <- exponential_coef[2]
# Calculate R-squared for the exponential model
r_squared_exp <- 1 - sum(residuals(exponential_model)^2) / sum((log(Nuptake_EVI$mean_Nuptake) - mean(log(Nuptake_EVI$mean_Nuptake)))^2)
# Plot the exponential relationship
exponential_Nuptake_EVI_plot <- Nuptake_EVI %>%
ggplot(aes(x = meanEVI, y = mean_Nuptake)) +
geom_point(aes(shape = factor(material)), size = 3) +
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue") +
labs(x = "EVI", y = "", title = "EVI vs N uptake (exponential)") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text(margin = margin(b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_EVI$meanEVI) + 0.02,
y = max(Nuptake_EVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2),
"\nCorrelation:", round(cor(Nuptake_EVI$meanEVI, Nuptake_EVI$mean_Nuptake), 2)
),
hjust = 0,
vjust = 1,
color = "black",
size = 6
)+
scale_shape_manual(values = c(16, 17))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_EVI_plot
Nuptake_EVI <- fuzzy_inner_join(mean_Nuptake, EVI,
by = c("date" = "date"),
match_fun = function(x, y) abs(difftime(x, y, units = "days")) <= 7) %>%
mutate(date_difference = abs(difftime(date.x, date.y, units = "days")))%>%
arrange(date_difference, decreasing = FALSE)
Nuptake_EVI <- Nuptake_EVI [-11, ]
Nuptake_EVI <- Nuptake_EVI %>%
group_by(date.x)%>%
summarise(mean_Nuptake = first(mean_Nuptake), meanEVI = first(meanEVI), material = first(material))
linear_model <- lm(mean_Nuptake ~ meanEVI, data = Nuptake_EVI)
summary(linear_model)
# Fit an exponential model
exponential_model <- lm(log(mean_Nuptake) ~ meanEVI, data = Nuptake_EVI)
summary(exponential_model)
# Extract coefficients
exponential_coef <- coef(exponential_model)
intercept_exp <- exponential_coef[1]
slope_exp <- exponential_coef[2]
# Calculate R-squared for the exponential model
r_squared_exp <- 1 - sum(residuals(exponential_model)^2) / sum((log(Nuptake_EVI$mean_Nuptake) - mean(log(Nuptake_EVI$mean_Nuptake)))^2)
# Plot the exponential relationship
exponential_Nuptake_EVI_plot <- Nuptake_EVI %>%
ggplot(aes(x = meanEVI, y = mean_Nuptake)) +
geom_point(aes(shape = factor(material)), size = 3) +
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue") +
labs(x = "EVI", y = "", title = "EVI vs N uptake (exponential)") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text(margin = margin(b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_EVI$meanEVI) + 0.02,
y = max(Nuptake_EVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2),
"\nCorrelation:", round(cor(Nuptake_EVI$meanEVI, Nuptake_EVI$mean_Nuptake), 2)
),
hjust = 0,
vjust = 1,
color = "black",
size = 6
)+
scale_shape_manual(values = c(16, 17))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_EVI_plot
# Plot the exponential relationship
exponential_Nuptake_EVI_plot <- Nuptake_EVI %>%
ggplot(aes(x = meanEVI, y = mean_Nuptake)) +
geom_point(aes(shape = factor(material)), size = 3) +
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue") +
labs(x = "EVI", y = "", title = "EVI vs N uptake (exponential)") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text(margin = margin(b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_EVI$meanEVI) + 0.02,
y = max(Nuptake_EVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2),
),
hjust = 0,
vjust = 1,
color = "black",
size = 6
)+
scale_shape_manual(values = c(16, 17))+
guides(shape = guide_legend(title = "Biomass type"))
# Plot the exponential relationship
exponential_Nuptake_EVI_plot <- Nuptake_EVI %>%
ggplot(aes(x = meanEVI, y = mean_Nuptake)) +
geom_point(aes(shape = factor(material)), size = 3) +
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue") +
labs(x = "EVI", y = "", title = "EVI vs N uptake (exponential)") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text(margin = margin(b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_EVI$meanEVI) + 0.02,
y = max(Nuptake_EVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)),
hjust = 0,
vjust = 1,
color = "black",
size = 6
)+
scale_shape_manual(values = c(16, 17))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_EVI_plot
# Plot the exponential relationship
exponential_Nuptake_EVI_plot <- Nuptake_EVI %>%
ggplot(aes(x = meanEVI, y = mean_Nuptake)) +
geom_point(aes(shape = factor(material)), size = 3) +
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue") +
labs(x = "EVI", y = "N uptake (g/m2)", title = "EVI vs N uptake (exponential)") +
theme_minimal() +
theme(
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text(margin = margin(b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_EVI$meanEVI) + 0.02,
y = max(Nuptake_EVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)),
hjust = 0,
vjust = 1,
color = "black",
size = 6
)+
scale_shape_manual(values = c(16, 17))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_EVI_plot
ggsave("EVIvsNuptake_exp.png", exponential_Nuptake_EVI_plot, width = 6, height = 10, dpi = 350)
ggsave("EVIvsNuptake_exp.png", exponential_Nuptake_EVI_plot, width = 7, height = 10, dpi = 350)
exponential_model <- lm(log(mean_Nuptake) ~ meanNDVI, data = Nuptake_NDVI)
summary(exponential_model)
# Extract coefficients
exponential_coef <- coef(exponential_model)
intercept_exp <- exponential_coef[1]
slope_exp <- exponential_coef[2]
r_squared_exp <- 1 - sum(residuals(exponential_model)^2) / sum((log(Nuptake_NDVI$mean_Nuptake) - mean(log(Nuptake_NDVI$mean_Nuptake)))^2)
exponential_Nuptake_NDVI_plot <- Nuptake_NDVI %>%
ggplot(aes(x = meanNDVI, y = mean_Nuptake, group = 1))+
geom_point(aes(shape = factor(material)), size = 3)+
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue", aes(group = 1))+
labs(x = "NDVI", y = "N uptake (g/m2)", title = "NDVI vs N uptake (exponential)")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_NDVI$meanNDVI) + 0.02,
y = max(Nuptake_NDVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)
),
hjust = 0, vjust = 1, color = "black", size = 6
)+
scale_shape_manual(values = c(16, 4))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_NDVI_plot
exponential_Nuptake_NDVI_plot <- Nuptake_NDVI %>%
ggplot(aes(x = meanNDVI, y = mean_Nuptake, group = 1))+
geom_point(aes(shape = factor(material)), size = 5, )+
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue", aes(group = 1))+
labs(x = "NDVI", y = "N uptake (g/m2)", title = "NDVI vs N uptake (exponential)")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_NDVI$meanNDVI) + 0.02,
y = max(Nuptake_NDVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)
),
hjust = 0, vjust = 1, color = "black", size = 6
)+
scale_shape_manual(values = c(16, 4))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_NDVI_plot
exponential_Nuptake_NDVI_plot <- Nuptake_NDVI %>%
ggplot(aes(x = meanNDVI, y = mean_Nuptake, group = 1))+
geom_point(aes(shape = factor(material)), size = 3, )+
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue", aes(group = 1))+
labs(x = "NDVI", y = "N uptake (g/m2)", title = "NDVI vs N uptake (exponential)")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_NDVI$meanNDVI) + 0.02,
y = max(Nuptake_NDVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)
),
hjust = 0, vjust = 1, color = "black", size = 6
)+
scale_shape_manual(values = c(16, 4))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_NDVI_plot
exponential_Nuptake_NDVI_plot <- Nuptake_NDVI %>%
ggplot(aes(x = meanNDVI, y = mean_Nuptake, group = 1))+
geom_point(aes(shape = factor(material)), size = 3, )+
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue", aes(group = 1))+
labs(x = "NDVI", y = "N uptake (g/m2)", title = "NDVI vs N uptake (exponential)")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_NDVI$meanNDVI) + 0.02,
y = max(Nuptake_NDVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)
),
hjust = 0, vjust = 1, color = "black", size = 6
)+
scale_shape_manual(values = c(16, 19))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_NDVI_plot
exponential_Nuptake_NDVI_plot <- Nuptake_NDVI %>%
ggplot(aes(x = meanNDVI, y = mean_Nuptake, group = 1))+
geom_point(aes(shape = factor(material)), size = 3, )+
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue", aes(group = 1))+
labs(x = "NDVI", y = "N uptake (g/m2)", title = "NDVI vs N uptake (exponential)")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_NDVI$meanNDVI) + 0.02,
y = max(Nuptake_NDVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)
),
hjust = 0, vjust = 1, color = "black", size = 6
)+
scale_shape_manual(values = c(16, 17))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_NDVI_plot
Nuptake_MCARI <- fuzzy_inner_join(mean_Nuptake, MCARI,
by = c("date" = "date"),
match_fun = function(x, y) abs(difftime(x, y, units = "days")) <= 7) %>%
mutate(date_difference = abs(difftime(date.x, date.y, units = "days")))%>%
arrange(date_difference, decreasing = FALSE)
Nuptake_MCARI <- Nuptake_MCARI [-11, ]
Nuptake_MCARI <- Nuptake_MCARI %>%
group_by(date.x)%>%
summarise(mean_Nuptake = first(mean_Nuptake), meanMCARI = first(meanMCARI), material = first(material))
linear_model <- lm(mean_Nuptake ~ meanMCARI, data = Nuptake_MCARI)
summary(linear_model)
# Fit an exponential model
exponential_model <- lm(log(mean_Nuptake) ~ meanMCARI, data = Nuptake_MCARI)
summary(exponential_model)
linear_model <- lm(mean_Nuptake ~ meanMCARI, data = Nuptake_MCARI)
summary(linear_model)
linear_coef <- coef(linear_model)
intercept <- linear_coef[1]
slope <- linear_coef[2]
r_squared <- 1 - sum(residuals(linear_model)^2) / sum((Nuptake_MCARI$mean_Nuptake - mean(Nuptake_MCARI$mean_Nuptake))^2)
linear_Nuptake_MCARI_plot <- Nuptake_MCARI%>%
ggplot(aes(x = meanMCARI, y = mean_Nuptake))+
geom_point()+
geom_smooth(method = lm, se = FALSE)+
labs(x = "MCARI", y = "", title = "MCARI vs N uptake")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22))+
annotate("text",
x = min(Nuptake_MCARI$meanMCARI) + 0.03,
y = max(Nuptake_MCARI$mean_Nuptake) - 0.4,
label = paste("y =", format(slope, digits = 3),
"*x +",
format(intercept, digits = 3),
"\nR2 =", round(r_squared, 2),
"\nCorrelation:", round(cor(Nuptake_MCARI$meanMCARI, Nuptake_MCARI$mean_Nuptake), 2)),
hjust = 0, vjust = 1, color = "black", size = 6)
linear_Nuptake_MCARI_plot
# Fit an exponential model
exponential_model <- lm(log(mean_Nuptake) ~ meanMCARI, data = Nuptake_MCARI)
summary(exponential_model)
save.image("~/GitHub/Nuptake_project/workspace(2).RData")
View(EVI)
EVI_plot
View(EVI)
View(mean_Nuptake)
install.packages("caret")
library(caret)
