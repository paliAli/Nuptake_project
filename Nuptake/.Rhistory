annotate(
"text",
x = min(Nuptake_NDVI$meanNDVI) + 0.02,
y = max(Nuptake_NDVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)
),
hjust = 0, vjust = 1, color = "black", size = 6
)+
scale_shape_manual(values = c(16, 4))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_NDVI_plot
exponential_Nuptake_NDVI_plot <- Nuptake_NDVI %>%
ggplot(aes(x = meanNDVI, y = mean_Nuptake, group = 1))+
geom_point(aes(shape = factor(material)), size = 3, )+
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue", aes(group = 1))+
labs(x = "NDVI", y = "N uptake (g/m2)", title = "NDVI vs N uptake (exponential)")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_NDVI$meanNDVI) + 0.02,
y = max(Nuptake_NDVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)
),
hjust = 0, vjust = 1, color = "black", size = 6
)+
scale_shape_manual(values = c(16, 4))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_NDVI_plot
exponential_Nuptake_NDVI_plot <- Nuptake_NDVI %>%
ggplot(aes(x = meanNDVI, y = mean_Nuptake, group = 1))+
geom_point(aes(shape = factor(material)), size = 3, )+
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue", aes(group = 1))+
labs(x = "NDVI", y = "N uptake (g/m2)", title = "NDVI vs N uptake (exponential)")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_NDVI$meanNDVI) + 0.02,
y = max(Nuptake_NDVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)
),
hjust = 0, vjust = 1, color = "black", size = 6
)+
scale_shape_manual(values = c(16, 19))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_NDVI_plot
exponential_Nuptake_NDVI_plot <- Nuptake_NDVI %>%
ggplot(aes(x = meanNDVI, y = mean_Nuptake, group = 1))+
geom_point(aes(shape = factor(material)), size = 3, )+
geom_smooth(method = lm, se = FALSE, formula = y ~ exp(x), color = "blue", aes(group = 1))+
labs(x = "NDVI", y = "N uptake (g/m2)", title = "NDVI vs N uptake (exponential)")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(Nuptake_NDVI$meanNDVI) + 0.02,
y = max(Nuptake_NDVI$mean_Nuptake) - 1,
label = paste(
"y = ",
"exp(",
format(slope_exp, digits = 2),
"*x +", format(exp(intercept_exp), digits = 2),
")\nR2 =", round(r_squared_exp, 2)
),
hjust = 0, vjust = 1, color = "black", size = 6
)+
scale_shape_manual(values = c(16, 17))+
guides(shape = guide_legend(title = "Biomass type"))
exponential_Nuptake_NDVI_plot
Nuptake_MCARI <- fuzzy_inner_join(mean_Nuptake, MCARI,
by = c("date" = "date"),
match_fun = function(x, y) abs(difftime(x, y, units = "days")) <= 7) %>%
mutate(date_difference = abs(difftime(date.x, date.y, units = "days")))%>%
arrange(date_difference, decreasing = FALSE)
Nuptake_MCARI <- Nuptake_MCARI [-11, ]
Nuptake_MCARI <- Nuptake_MCARI %>%
group_by(date.x)%>%
summarise(mean_Nuptake = first(mean_Nuptake), meanMCARI = first(meanMCARI), material = first(material))
linear_model <- lm(mean_Nuptake ~ meanMCARI, data = Nuptake_MCARI)
summary(linear_model)
# Fit an exponential model
exponential_model <- lm(log(mean_Nuptake) ~ meanMCARI, data = Nuptake_MCARI)
summary(exponential_model)
linear_model <- lm(mean_Nuptake ~ meanMCARI, data = Nuptake_MCARI)
summary(linear_model)
linear_coef <- coef(linear_model)
intercept <- linear_coef[1]
slope <- linear_coef[2]
r_squared <- 1 - sum(residuals(linear_model)^2) / sum((Nuptake_MCARI$mean_Nuptake - mean(Nuptake_MCARI$mean_Nuptake))^2)
linear_Nuptake_MCARI_plot <- Nuptake_MCARI%>%
ggplot(aes(x = meanMCARI, y = mean_Nuptake))+
geom_point()+
geom_smooth(method = lm, se = FALSE)+
labs(x = "MCARI", y = "", title = "MCARI vs N uptake")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22))+
annotate("text",
x = min(Nuptake_MCARI$meanMCARI) + 0.03,
y = max(Nuptake_MCARI$mean_Nuptake) - 0.4,
label = paste("y =", format(slope, digits = 3),
"*x +",
format(intercept, digits = 3),
"\nR2 =", round(r_squared, 2),
"\nCorrelation:", round(cor(Nuptake_MCARI$meanMCARI, Nuptake_MCARI$mean_Nuptake), 2)),
hjust = 0, vjust = 1, color = "black", size = 6)
linear_Nuptake_MCARI_plot
# Fit an exponential model
exponential_model <- lm(log(mean_Nuptake) ~ meanMCARI, data = Nuptake_MCARI)
summary(exponential_model)
save.image("~/GitHub/Nuptake_project/workspace(2).RData")
View(EVI)
EVI_plot
View(EVI)
View(mean_Nuptake)
install.packages("caret")
library(caret)
View(mean_Nuptake)
View(mean_nitrogen_uptake)
View(nitrogen_uptake)
library(fuzzyjoin)
library(dplyr)
library(ggplot2)
library(ggthemes)
mean_Nuptake <- mean_Nuptake[which(mean_Nuptake$date <= "2023-06-01"),]
Nuptake_NDVI <- fuzzy_inner_join(mean_Nuptake, NDVI,
by = c("date" = "date"),
match_fun = function(x, y) abs(difftime(x, y, units = "days")) <= 7) %>%
mutate(date_difference = abs(difftime(date.x, date.y, units = "days")))%>%
arrange(date_difference, decreasing = FALSE)
#I have to manually select the dates where the date difference is lower for NDVI measured after the cut, I want to keep the NDVI from before the cut
Nuptake_NDVI <- Nuptake_NDVI [-11, ]
Nuptake_NDVI <- Nuptake_NDVI %>%
group_by(date.x)%>%
summarise(mean_Nuptake = first(mean_Nuptake), meanNDVI = first(meanNDVI), material = first(material))
linear_model <- lm(mean_Nuptake ~ meanNDVI, data = Nuptake_NDVI)
summary(linear_model)
linear_coef <- coef(linear_model)
intercept <- linear_coef[1]
slope <- linear_coef[2]
r_squared <- 1 - sum(residuals(linear_model)^2) / sum((Nuptake_NDVI$mean_Nuptake - mean(Nuptake_NDVI$mean_Nuptake))^2)
linear_Nuptake_NDVI_plot <- Nuptake_NDVI %>%
ggplot(aes(x = meanNDVI, y = mean_Nuptake))+
geom_point()+
geom_smooth(method = lm, se = FALSE)+
labs(x = "NDVI", y = "N uptake (g/m2)", title = "NDVI vs N uptake")+
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22))+
annotate("text",
x = min(Nuptake_NDVI$meanNDVI) + 0.06,
y = max(Nuptake_NDVI$mean_Nuptake) - 0.9,
label = paste("y =", format(slope, digits = 2),
"*x +",
format(intercept, digits = 2),
"\nR2 =", round(r_squared, 2),
"\nCorrelation:", round(cor(Nuptake_NDVI$meanNDVI, Nuptake_NDVI$mean_Nuptake), 2)),
hjust = 0, vjust = 1, color = "black", size = 6)
linear_Nuptake_NDVI_plot
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(log(mean_Nuptake) ~ meanNDVI, data = Nuptake_NDVI, method = "lm", trControl = ctrl)
library(caret)
set.seed(123)
#specify the cross-validation method
ctrl <- trainControl(method = "LOOCV")
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(log(mean_Nuptake) ~ meanNDVI, data = Nuptake_NDVI, method = "lm", trControl = ctrl)
LOOCV_model
coefficients <- coef(LOOCV_model$finalModel)
print(coefficients)
# Predict using LOOCV model
predictions <- predict(LOOCV_model, newdata = Nuptake_NDVI, type = "raw")
print(predictions)
# Create a data frame with actual and predicted values
#must do exp(predictions) to undo the logarithmic transformation and get true Nuptake values
results_NDVI <- data.frame(Actual = Nuptake_NDVI$mean_Nuptake, Predicted = exp(predictions))
# Calculate R-squared on the original scale
y_actual <- Nuptake_NDVI$mean_Nuptake
y_predicted <- exp(predictions)
ss_residual <- sum((y_actual - y_predicted)^2)
ss_total <- sum((y_actual - mean(y_actual))^2)
r_squared <- 1 - (ss_residual / ss_total)
# Calculate RMSE
rmse <- sqrt(mean((Nuptake_NDVI$mean_Nuptake - results_NDVI$Predicted)^2))
Nuptake_NDVI_prediction <- results_NDVI %>%
ggplot(aes(x = Actual, y = Predicted)) +
geom_point(size = 3, ) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red") +
labs(x = "Actual", y = "Predicted", title = "NDVI Actual vs. Predicted Values") +
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(results_NDVI$Actual)+1,
y = max(results_NDVI$Predicted)-0.5,
label = paste(
"R² =", round(r_squared, 3),
"\nRMSE =", round(rmse, 3)
),
hjust = 0, vjust = 1, color = "black", size = 6
)
Nuptake_NDVI_prediction
ctrl <- trainControl(
method = 'LOOCV',
number = 1,
savePredictions = 'final',
classProbs = T ,
seed = as.list(rep(1,12)),
summaryFunction=twoClassSummary
)
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(log(mean_Nuptake) ~ meanNDVI, data = Nuptake_NDVI, method = "lm", trControl = ctrl)
ctrl <- trainControl(
method = 'LOOCV',
number = 1,
savePredictions = 'final',
classProbs = T
)
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(log(mean_Nuptake) ~ meanNDVI, data = Nuptake_NDVI, method = "lm", trControl = ctrl)
LOOCV_model
linear_model <- lm(mean_Nuptake ~ meanNDVI, data = Nuptake_NDVI)
summary(linear_model)
linear_model <- lm(mean_Nuptake ~ meanNDVI, data = Nuptake_NDVI)
summary(linear_model)
# Linear N uptake vs NDVI -------------------------------------------------
set.seed(123)
linear_model <- lm(mean_Nuptake ~ meanNDVI, data = Nuptake_NDVI)
summary(linear_model)
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(log(mean_Nuptake) ~ meanNDVI, data = Nuptake_NDVI, method = "lm", trControl = ctrl)
#specify the cross-validation method
ctrl <- trainControl(method = "LOOCV")
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(log(mean_Nuptake) ~ meanNDVI, data = Nuptake_NDVI, method = "lm", trControl = ctrl)
LOOCV_model
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(mean_Nuptake ~ meanNDVI, data = Nuptake_NDVI, method = "lm", trControl = ctrl)
LOOCV_model
coefficients <- coef(LOOCV_model$finalModel)
print(coefficients)
# Predict using LOOCV model
predictions <- predict(LOOCV_model, newdata = Nuptake_NDVI, type = "raw")
print(predictions)
# Create a data frame with actual and predicted values
#must do exp(predictions) to undo the logarithmic transformation and get true Nuptake values
results_NDVI <- data.frame(Actual = Nuptake_NDVI$mean_Nuptake, Predicted = predictions)
# Calculate R-squared on the original scale
y_actual <- Nuptake_NDVI$mean_Nuptake
y_predicted <- predictions
ss_residual <- sum((y_actual - y_predicted)^2)
ss_total <- sum((y_actual - mean(y_actual))^2)
r_squared <- 1 - (ss_residual / ss_total)
# Calculate RMSE
rmse <- sqrt(mean((Nuptake_NDVI$mean_Nuptake - results_NDVI$Predicted)^2))
Nuptake_NDVI_prediction <- results_NDVI %>%
ggplot(aes(x = Actual, y = Predicted)) +
geom_point(size = 3, ) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red") +
labs(x = "Actual", y = "Predicted", title = "NDVI Actual vs. Predicted Values") +
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(results_NDVI$Actual)+1,
y = max(results_NDVI$Predicted)-0.5,
label = paste(
"R² =", round(r_squared, 3),
"\nRMSE =", round(rmse, 3)
),
hjust = 0, vjust = 1, color = "black", size = 6
)
Nuptake_NDVI_prediction
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(mean_Nuptake ~ meanNDRE, data = Nuptake_NDRE, method = "lm", trControl = ctrl)
LOOCV_model
# Predict using LOOCV model
predictions <- predict(LOOCV_model, newdata = Nuptake_NDRE, type = "raw")
print(predictions)
# Create a data frame with actual and predicted values
#must do exp(predictions) to undo the logarithmic transformation and get true Nuptake values
results_NDRE <- data.frame(Actual = Nuptake_NDRE$mean_Nuptake, Predicted = predictions)
# Calculate R-squared on the original scale
y_actual <- Nuptake_NDRE$mean_Nuptake
y_predicted <- predictions
ss_residual <- sum((y_actual - y_predicted)^2)
ss_total <- sum((y_actual - mean(y_actual))^2)
r_squared <- 1 - (ss_residual / ss_total)
# Calculate RMSE
rmse <- sqrt(mean((Nuptake_NDRE$mean_Nuptake - results_NDRE$Predicted)^2))
# Scatter plot
library(ggplot2)
Nuptake_NDRE_prediction <- results_NDRE %>%
ggplot(aes(x = Actual, y = Predicted)) +
geom_point(size = 3, ) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red") +
labs(x = "Actual", y = "Predicted", title = "NDRE Actual vs. Predicted Values") +
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(results_NDRE$Actual)+1,
y = max(results_NDRE$Predicted)-0.5,
label = paste(
"R² =", round(r_squared, 3),
"\nRMSE =", round(rmse, 3)
),
hjust = 0, vjust = 1, color = "black", size = 6
)
Nuptake_NDRE_prediction
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(mean_Nuptake ~ meanMCARI, data = Nuptake_MCARI, method = "lm", trControl = ctrl)
LOOCV_model
# Predict using LOOCV model
predictions <- predict(LOOCV_model, newdata = Nuptake_MCARI, type = "raw")
print(predictions)
# Create a data frame with actual and predicted values
#must do exp(predictions) to undo the logarithmic transformation and get true Nuptake values
results_MCARI <- data.frame(Actual = Nuptake_MCARI$mean_Nuptake, Predicted = predictions)
# Calculate R-squared on the original scale
y_actual <- Nuptake_MCARI$mean_Nuptake
y_predicted <- predictions
ss_residual <- sum((y_actual - y_predicted)^2)
ss_total <- sum((y_actual - mean(y_actual))^2)
r_squared <- 1 - (ss_residual / ss_total)
# Calculate RMSE
rmse <- sqrt(mean((Nuptake_MCARI$mean_Nuptake - results_MCARI$Predicted)^2))
# Scatter plot
library(ggplot2)
Nuptake_MCARI_prediction <- results_MCARI %>%
ggplot(aes(x = Actual, y = Predicted)) +
geom_point(size = 3, ) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red") +
labs(x = "Actual", y = "Predicted", title = "MCARI Actual vs. Predicted Values") +
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(results_MCARI$Actual)+1,
y = max(results_MCARI$Predicted)-0.5,
label = paste(
"R² =", round(r_squared, 3),
"\nRMSE =", round(rmse, 3)
),
hjust = 0, vjust = 1, color = "black", size = 6
)
Nuptake_MCARI_prediction
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(mean_Nuptake ~ meanEVI, data = Nuptake_EVI, method = "lm", trControl = ctrl)
LOOCV_model
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(mean_Nuptake ~ meanEVI, data = Nuptake_EVI, method = "lm", trControl = ctrl)
LOOCV_model
# Predict using LOOCV model
predictions <- predict(LOOCV_model, newdata = Nuptake_EVI, type = "raw")
print(predictions)
# Create a data frame with actual and predicted values
#must do exp(predictions) to undo the logarithmic transformation and get true Nuptake values
results_EVI <- data.frame(Actual = Nuptake_EVI$mean_Nuptake, Predicted = predictions)
# Calculate R-squared on the original scale
y_actual <- Nuptake_EVI$mean_Nuptake
y_predicted <- predictions
ss_residual <- sum((y_actual - y_predicted)^2)
ss_total <- sum((y_actual - mean(y_actual))^2)
r_squared <- 1 - (ss_residual / ss_total)
# Calculate RMSE
rmse <- sqrt(mean((Nuptake_EVI$mean_Nuptake - results_EVI$Predicted)^2))
# Scatter plot
library(ggplot2)
Nuptake_EVI_prediction <- results_EVI %>%
ggplot(aes(x = Actual, y = Predicted)) +
geom_point(size = 3, ) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red") +
labs(x = "Actual", y = "Predicted", title = "EVI Actual vs. Predicted Values") +
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(results_EVI$Actual)+1,
y = max(results_EVI$Predicted)-0.5,
label = paste(
"R² =", round(r_squared, 3),
"\nRMSE =", round(rmse, 3)
),
hjust = 0, vjust = 1, color = "black", size = 6
)
Nuptake_EVI_prediction
residual <- sum(y_actual - y_predicted)
# Take absolute values of residuals
abs_residuals <- abs(residuals)
# Calculate MAE
mae <- mean(abs_residuals)
# Take absolute values of residuals
residuals <- abs(residuals)
residual <- y_actual - y_predicted
# Take absolute values of residuals
abs_residuals <- abs(residuals)
#fit a regression model and use LOOCV to evaluate performance
LOOCV_model <- train(mean_Nuptake ~ meanNDVI, data = Nuptake_NDVI, method = "lm", trControl = ctrl)
LOOCV_model
coefficients <- coef(LOOCV_model$finalModel)
print(coefficients)
# Predict using LOOCV model
predictions <- predict(LOOCV_model, newdata = Nuptake_NDVI, type = "raw")
print(predictions)
# Create a data frame with actual and predicted values
#must do exp(predictions) to undo the logarithmic transformation and get true Nuptake values
results_NDVI <- data.frame(Actual = Nuptake_NDVI$mean_Nuptake, Predicted = predictions)
# Calculate R-squared on the original scale
y_actual <- Nuptake_NDVI$mean_Nuptake
y_predicted <- predictions
ss_residual <- sum((y_actual - y_predicted)^2)
ss_total <- sum((y_actual - mean(y_actual))^2)
r_squared <- 1 - (ss_residual / ss_total)
# Calculate RMSE
rmse <- sqrt(mean((Nuptake_NDVI$mean_Nuptake - results_NDVI$Predicted)^2))
# Scatter plot
library(ggplot2)
Nuptake_NDVI_prediction <- results_NDVI %>%
ggplot(aes(x = Actual, y = Predicted)) +
geom_point(size = 3, ) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red") +
labs(x = "Actual", y = "Predicted", title = "NDVI Actual vs. Predicted Values") +
theme_minimal()+
theme(axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
axis.title.x = element_text(margin = margin(t = 20), size = 15),
axis.title.y = element_text(margin = margin(r = 20), size = 15),
plot.title = element_text (margin = margin (b = 20), size = 22),
legend.title = element_text(size = 14),
legend.text = element_text(size = 13))+
annotate(
"text",
x = min(results_NDVI$Actual)+1,
y = max(results_NDVI$Predicted)-0.5,
label = paste(
"R² =", round(r_squared, 3),
"\nRMSE =", round(rmse, 3)
),
hjust = 0, vjust = 1, color = "black", size = 6
)
Nuptake_NDVI_prediction
